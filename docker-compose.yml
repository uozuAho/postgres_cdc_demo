version: '3'
services:
  db_source_of_truth:
    container_name: db_truth
    build:
      context: .
      dockerfile: ./Dockerfile.truth_db
    ports:
      - "5432:5432"
    environment:
      - POSTGRES_DB=my_db
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=postgres
  localstack:
    image: localstack/localstack
    ports:
      - "53:53"
      - "443:443"
      - "4510-4520:4510-4520"
      - "4566-4620:4566-4620"
      - "8080:8080"  # web ui
    environment:
      - LOCALSTACK_API_KEY=asdf
      - SERVICES=kinesis
      # - DEBUG=1
      # - DATA_DIR=/tmp/localstack/data
      # - DOCKER_HOST=unix:///var/run/docker.sock
      # - HOST_TMP_FOLDER=${TMPDIR}
    # volumes:
    #   - "${TMPDIR:-/tmp/localstack}:/tmp/localstack"
    #   - "/var/run/docker.sock:/var/run/docker.sock"
